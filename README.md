# README

## **Santa Tell Me**

### 등산 입문자들이 등산을 즐길 수 있도록 하는 앱

- 프로젝트 선정 배경

최근 많은 사람들에게 등산이 인기 있는 운동으로 주목 받게 되면서 등산 입문자들이 증가했다. 이들이 등산을 쉽고 재밌게 할 수 있도록 이 프로젝트를 구상했다.

## 앱의 주요 기능

- 유저의 위치를 기준으로 가까운 명산들을 알려줌
- 등산을 하기 전 산을 선택할 때 필요한 산의 주요 정보를 제공
- 등산을 할 때 기본적인 등산 경로를 알려주는 가이드 기능
- 게임처럼 등산을 즐길 수 있도록 등산 완료할 시 업적 부여
- 업적을 통해 등산 누적 시간, 도달률, 산 이름 등 자신의 등산 기록을 볼 수 있음

## 개발 환경

- Android Studio
- Firebase

## UI / UX 디자인 설명

- 사용자들이 앱에서 제공하는 서비스나 기능들이 무엇인지 직관적으로 알 수 있도록 화면을 구성

   

![캡처2](https://user-images.githubusercontent.com/111959522/206559063-a1e5d46f-fc2f-4b98-8df6-d3265b56b39e.PNG)

---

- stroke, corners, solid, shape 등 다양한 태그를 사용한 drawable 객체를 만들어 화면을 나누고 버튼 디자인에 주로 사용

![캡처3](https://user-images.githubusercontent.com/111959522/206559331-a9ced166-2868-42f9-b7f5-056083e77adc.PNG)

![캡처1](https://user-images.githubusercontent.com/111959522/206558052-0be56820-ae21-4217-b81a-1f5646c83650.PNG)

## 주요 코드 설명

![Untitled](README%200c4f7ef95c57472db1dc87c7ac55d187/Untitled%203.png)

# 위치권한 활용 허용 요청

저희 어플은 위치정보 활용이 필수적입니다. 그래서 사용자는 꼭 위치정보 활용에 동의 해주어야 서비스 이용이 가능합니다. 

1. 위치정보 활용 동의 허용 했을시
    
    → 로그인 화면으로 넘어갑니다. 
    
2. 거절한 경우
    
    → 앱을 이용할 수 없음을 안내하고, 앱을 종료합니다.
    
    → 대략적인 위치와 정확한 위치 모두 허용해야합니다.
    

 

### 1-1. 사용자가 위치정보 활용 동의

![Untitled](README%200c4f7ef95c57472db1dc87c7ac55d187/Untitled%204.png)

사용자가 위치정보 활용에 동의한 경우에는 intent로 로그인 엑티비티를 열어줍니다.

거부한 경우에는 위치정보 활용에 동의해야함을 고지하고, 앱을 종료합니다. 

---

![Untitled](README%200c4f7ef95c57472db1dc87c7ac55d187/Untitled%205.png)

메인화면에 진입하면 지도와 리스트가 주어집니다. 지도에는 DB에 올라가있는 모든 산의 위치를 표시합니다.

UPDATE 버튼을 누르면 산 리스트를 정렬합니다. 기준은 내 위치와 가까운 순입니다.

 

![Untitled](README%200c4f7ef95c57472db1dc87c7ac55d187/Untitled%206.png)

UPDATE 버튼과 연결된 onClick Listener입니다. DB에서 불러온 산의 갯수만큼 반복문을 돌며 동적으로 뷰를 생성합니다. 

초록색 박스 코드는 산들을 내 위치를 기준으로 정렬하는 코드입니다. 정렬 방식은 좌표평면 위에 나를 기준으로 모든 산을 올리고, 점과 점 사이의 거리를 구하는 방식으로 계산했습니다. 모든 산과의 거리를 구해 가까운 순으로 정렬합니다.

붉은색 박스 코드는 이미 리스트에 아이템이 올라가 있는경우, 아이템들을 삭제하는 코드입니다.

파란색 박스 코드는 정렬된 산들을 리스트에 동적으로 생성하는 코드입니다.

---

![Untitled](README%200c4f7ef95c57472db1dc87c7ac55d187/Untitled%207.png)

# 등산 시작

파란색 선은 관리자가 등록한 등산 경로이고, 붉은 선은 유저의 이동 경로입니다.

유저는 이 정보를 통해 현재 자신이 경로를 벗어났는지 아닌지를 판단합니다.

GPS의 정확도 문제인지 같은 경로로 걷더라도 두 경로가 완전히 일치하지는 않습니다. 하지만 경로이탈을 판단하기에는 무리가 없다고 판단했습니다. 

상단에는 등산 시간, 선택한 난이도, 목표 고도가 표시됩니다.

STOP 버튼을 누르면 목표 고도를 달성하지 않아도 언제든 중간에 그만둘 수 있도록 기획했습니다.

![Untitled](README%200c4f7ef95c57472db1dc87c7ac55d187/Untitled%208.png)

구글의 elevation api를 이용한 고도계산 메소드입니다. http통신은 okhttp를 이용했습니다.

![Untitled](README%200c4f7ef95c57472db1dc87c7ac55d187/Untitled%209.png)

붉은색 박스친 drawLine 메소드는 저희가 db에 등록한 가이드용 등산경로를 파란색 선으로 지도에 표시하는 메소드입니다.

하단에 파란색 박스친 drawLine 메소드는 사용자의 현재 경로를 붉은색으로 지도에 표시합니다.

![Untitled](README%200c4f7ef95c57472db1dc87c7ac55d187/Untitled%2010.png)

위치정보를 받아와 관련된 처리를 하는 LocationCallback 메소드입니다.

이곳에서 유저의 현재 위치를 받아오는 것부터 고도처리, 현재경로 표시 전부 실행합니다.

고도계산은 외부 인터넷에 접근해야하는 작업이기 때문에 별도의 쓰레드를 이용해서 처리했습니다.

## 중간 피드백 내용 & 수용 내용

1. 등산중 실시간 날씨변화에 대응해 갑작스런 기상악화에 사용자가 대응할 수있게 경고해주는 기능
    
    → 실시간으로 날씨를 확인 할 수있는 기술을 확보하지 못 했습니다. 보통의 날씨 api들은 몇 시간 단위 날씨를 제공해주는 api들로, 실시간 날씨를 처리하기엔 무리가 있었습니다. 그래서 이에대한 대안으로 등산 시작 전에 오늘의 날씨를 확인하고, 기상악화가 우려되는 날에는 유저에게 경고를 하는 식으로 기획을 하였으나 날씨를 담당하던 팀원의 프로젝트 참여가 어려워져서 구현하지는 못 하였습니다.
    
2. 경로를 추천할 때, 초심자의 경우 위험한길로 빠지지 않도록 경고하는 기능
    
    → 저희가 구현할 수있는 수준안에서 최대한으로 구현 해보았습니다. 우리가 추천해준 경로와 현재 유저가 이동중인 경로를 모두 지도에 표시해서 유저가 경로를 이탈하지 않도록 가이드 하는 기능을 구현했습니다.
    

1. 가산점 활용 요소 추가 검토
    
    → 초기에 경진대회에 참여를 목표로 3주차부터 타이트하게 안드로이드 스터디도 진행하고 프로젝트도 바로 진행 하였으나 구현에 실패하였고, 출품을 하지 못 했습니다. 하지만 이때 공부했던 내용들이 추후 프로젝트에 많은 도움이 되었습니다.
    
    →  산림청 , 구글맵 api, elevation api등 다양한 api활용을 검토했습니다.
    
    → 직접 php로 서버와 데이터베이스를 구축했으나 여러 이슈가 발생하여 firebase를 이용하기로 했습니다. @성준 박 여기에 백엔드 진행하면서 겪었던 이슈들 언급해주시면 좋을듯
    

## 초기 기획과 최종 결과물의 차이점

## 초기 기획

- 전국 명산 도장깨기 어플. 위치데이터를 이용해서 특정 고도 이상 도달시 그 산을 정복.
- 게임처럼 업적, 칭호 시스템
- 등산 뿐만 아니라 운동일지 기록 ex) 헬스 , 런닝
- 등산 커뮤니티
- 무전기 기능
- 경로 추천 기능
- 등산 기록 저장, 추후에 언제든 확인가능

초기에 많은 아이디어들이 나왔지만 실질적으로 구현된 기능은 붉은색으로 표시한 세 가지 입니다.

구현에 성공한 기능들이 사실 저희 어플의 핵심이기 때문에 프로젝트가 실패했다는 생각을 하진 않지만 많은 아쉬움이 남습니다. 초기 기획단계에서 치밀하게 프로그램 구조를 확립하는 부분이 많이 미흡했던 것 같았던 것 같습니다. 그렇다 보니 추가 기능을 넣기위해서 많은 부분을 수정해야 했고, 예상보다 많은 시간이 소요되었고, 예상치 못한 오류들도 많이 발생했습니다. 다음에 프로젝트를 진행한다면 이런 경험을 되새겨 개발 전에 프로그램의 구조를 명확히 하여야 겠다는 생각을 했습니다.
